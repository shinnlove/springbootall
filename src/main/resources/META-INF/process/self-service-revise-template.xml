<?xml version="1.0" encoding="utf-8"?>
<template id="40003" name="self_service_revise_process" desc="自助改价流程" parent="">

    <metadata>
        <status no="-1" name="init" desc="流程初始化"/>
        <status no="1" name="customer_confirm" desc="待客户确认"/>
        <status no="2" name="accepted" desc="自助改价已完成"/>
        <status no="3" name="rejected" desc="自助改价已拒绝"/>
        <status no="4" name="canceled" desc="自助改价已取消"/>
    </metadata>

    <init>
        <handler seq="1" ref="processCreateReviseHandler" desc="创建自助改价流程"/>
    </init>

    <accepted>
        <handler seq="1" ref="processAcceptedTrigger" desc="自助改价完成后trigger"/>
    </accepted>

    <rejected>
        <handler seq="1" ref="processRejectedTrigger" desc="自助改价拒绝后trigger"/>
    </rejected>

    <canceled>
        <handler seq="1" ref="processCanceledTrigger" desc="自助改价流程关闭后的trigger"/>
    </canceled>

    <action id="40301" name="upper_enroll" desc="UP主报名D活动" destination="1" entrance="true">
        <handler seq="1" ref="validateUpperEnrollDHandler" desc="检验UP主重复报名D类任务处理器"/>
        <handler seq="2" ref="delegateRegisterUpperHandler" desc="委托注册UP主处理器"/>
    </action>

    <action id="40302" name="enroll_attach_tag" desc="稿件绑定标签" destination="2">
        <handler seq="1" ref="upperDPromoteToIngHandler" desc="UP主推进D类任务到进行中处理器"/>
        <handler seq="2" ref="buildDraftTagRelationHandler" desc="构建稿件标签映射关系处理器"/>
    </action>

    <action id="40303" name="detach_all_tag" desc="取消绑定标签" destination="1">
        <handler seq="1" ref="upperDRevokeToSignUpHandler" desc="UP的D类任务状态回退到已报名"/>
        <handler seq="2" ref="buildDraftTagRelationHandler" desc="构建稿件标签映射关系处理器"/>
    </action>

    <action id="40304" name="attach_tag_enroll" desc="标签报名" destination="2" entrance="true">
        <handler seq="1" ref="delegateRegisterUpperHandler" desc="委托注册UP主处理器"/>
        <handler seq="2" ref="validateTagEnrollDHandler" desc="检验UP主重复报名D类任务处理器"/>
    </action>

    <action id="40305" name="finish_no_rewards" desc="完成活动" destination="4">
        <handler seq="1" ref="commonValidationHandler" desc="通用验证handler demo"/>
        <handler seq="2" ref="commonProcessHandler" desc="通用流程控制器demo"/>
    </action>

    <action id="40306" name="finish_with_rewards" desc="导入中奖名单" destination="3">
        <handler seq="1" ref="commonValidationHandler" desc="通用验证handler demo"/>
        <handler seq="2" ref="commonProcessHandler" desc="通用流程控制器demo"/>
    </action>

    <action id="40307" name="financial_paid" desc="财务已打款" destination="4">
        <handler seq="1" ref="commonValidationHandler" desc="通用验证handler demo"/>
        <handler seq="2" ref="commonProcessHandler" desc="通用流程控制器demo"/>
    </action>

    <action id="40308" name="d_upper_cancel" desc="终止任务" destination="5">
        <handler seq="1" ref="commonValidationHandler" desc="通用验证handler demo"/>
        <handler seq="2" ref="commonProcessHandler" desc="通用流程控制器demo"/>
    </action>

</template>
