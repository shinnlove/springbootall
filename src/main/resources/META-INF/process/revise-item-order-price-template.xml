<?xml version="1.0" encoding="utf-8"?>
<template id="30001" name="revise_item_order_price_template" desc="单个改价项订单金额子流程" parent="30000">

    <metadata>
        <status no="-1" seq="1" name="init" desc="流程初始化" ps="-1"/>
        <status no="1" seq="2" name="risk_audit" desc="待风控审核" ps="1"/>
        <status no="2" seq="3" name="customer_confirm" desc="待客户确认" ps="2"/>
        <status no="4" seq="4" name="accepted" desc="改价项已完成" ps="4"/>
        <status no="5" seq="5" name="rejected" desc="改价项已拒绝" ps="5"/>
        <status no="6" seq="6" name="canceled" desc="改价项已取消" ps="6"/>
    </metadata>

    <init>
        <pre>
            <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        </pre>
        <dispatch>
            <destination no="1">
                <handler seq="1" ref="notifyRiskAuditHandler" desc="通知风控审核"/>
            </destination>
            <destination no="2">
                <handler seq="1" ref="notifyAdvertiserConfirmHandler" desc="通知客户审核"/>
            </destination>
        </dispatch>
        <post>
            <handler seq="1" ref="notifyAdvertiserConfirmHandler" desc="通知客户审核"/>
        </post>
    </init>

    <accepted>
        <handler seq="1" ref="acceptProcessHandler" desc="单个改价项完成后trigger"/>
    </accepted>

    <rejected>
        <handler seq="1" ref="rejectProcessHandler" desc="单个改价项拒绝后trigger"/>
    </rejected>

    <canceled>
        <handler seq="1" ref="cancelProcessHandler" desc="单个改价项流程关闭后的trigger"/>
    </canceled>

    <action id="30103" name="order_audit_pass_pending_confirm" desc="订单金额改价项风控审核通过待客户确认" source="1" destination="2">
        <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        <handler seq="2" ref="notifyAdvertiserConfirmHandler" desc="通知客户审核"/>
    </action>

    <action id="30104" name="order_revise_accomplish" desc="订单金额改价项完成" source="2" destination="4">
        <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        <handler seq="2" ref="notifyAdvertiserHandler" desc="改价通知客户"/>
    </action>

    <action id="30105" name="order_revise_reject" desc="订单金额改价项拒绝" source="1" destination="5">
        <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        <handler seq="2" ref="notifyAdvertiserHandler" desc="改价通知客户"/>
    </action>

    <action id="30105" name="order_revise_reject" desc="订单金额改价项拒绝" source="2" destination="5">
        <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        <handler seq="2" ref="notifyAdvertiserHandler" desc="改价通知客户"/>
    </action>

    <action id="30106" name="order_revise_cancel" desc="订单金额改价项取消" source="1" destination="6">
        <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        <handler seq="2" ref="notifyAdvertiserHandler" desc="改价通知客户"/>
    </action>

    <action id="30106" name="order_revise_cancel" desc="订单金额改价项取消" source="2" destination="6">
        <handler seq="1" ref="updateRegisterStatusHandler" desc="更新注册表状态"/>
        <handler seq="2" ref="notifyAdvertiserHandler" desc="改价通知客户"/>
    </action>

</template>
